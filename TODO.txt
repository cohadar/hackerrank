better rand.py with sorted support